<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>David Gilmour Management - Fan Connect</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: #fff;
      text-align: center;
      padding: 30px;
    }
    .step {
      display: none;
      margin: 20px auto;
      padding: 20px;
      max-width: 600px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    button {
      background: #1db954;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background: #1ed760;
    }
    input, select {
      padding: 10px;
      border-radius: 6px;
      border: none;
      margin: 5px;
      width: 90%;
    }
    .wallet {
      background: #000;
      color: #0f0;
      padding: 10px;
      border-radius: 6px;
      word-break: break-all;
    }
  </style>
</head>
<body>

  <h1>üé∏ David Gilmour Management - Fan Connect</h1>
  <p>Welcome! Follow the steps below to connect with management.</p>

  <!-- Step 1 -->
  <div id="step1" class="step">
    <h2>Step 1: Start Short Chat</h2>
    <p>Click below to start your free 5-minute short chat with management.</p>
    <button onclick="startShortChat()">Start Live Chat</button>
    <p id="chatInstruction"></p>
  </div>

  <!-- Step 2 -->
  <div id="step2" class="step">
    <h2>Step 2: Enter Management Code</h2>
    <input type="text" id="mgmtCode" placeholder="Enter management code">
    <button onclick="verifyCode()">Submit</button>
    <p id="codeMsg"></p>
  </div>

  <!-- Step 3 -->
  <div id="step3" class="step">
    <h2>Step 3: Make Payment</h2>
    <select id="paymentPlan">
      <option value="100">üí¨ 30 mins Video Call - $100</option>
      <option value="250">üí¨ 1hr 30 mins Video Call - $250</option>
      <option value="50">üìû Voice Call - $1000</option>
    </select>
    <p>BTC Wallet Address:</p>
    <div class="wallet" onclick="copyWallet('btc')">bc1ql3q2jen3qd567f084eth0h7vr8cx2cftpmur6u</div>
    <p>USDT (TRC20) Wallet Address:</p>
    <div class="wallet" onclick="copyWallet('usdt')">TVkLPyef8rhjscVqEzfq87aw7cTNu8udaQ</div>
    <button onclick="markPaymentDone()">I Have Made Payment</button>
    <p id="payMsg"></p>
  </div>

  <!-- Step 4 -->
  <div id="step4" class="step">
    <h2>Step 4: Submit Payment Details</h2>
    <input type="text" id="fanName" placeholder="Your Name">
    <input type="email" id="fanEmail" placeholder="Your Email">
    <input type="text" id="paymentRef" placeholder="Payment Reference / TxID">
    <button onclick="submitDetails()">Submit</button>
    <p id="detailMsg"></p>
  </div>

  <!-- Step 5 -->
  <div id="step5" class="step">
    <h2>Step 5: Enter Access Code</h2>
    <input type="text" id="accessCode" placeholder="Enter access code">
    <button onclick="verifyAccessCode()">Submit</button>
    <p id="accessMsg"></p>
  </div>

  <!-- Tawk.to Script -->
  <script type="text/javascript">
    var Tawk_API = Tawk_API || {};
    (function(){
      var s1=document.createElement("script"),s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/66d9c40550c10f7a00a9b785/1i6se7q4f';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
    })();
  </script>

  <script>
    // RESET on very first visit
    if(!localStorage.getItem("firstVisit")) {
      localStorage.clear();
      localStorage.setItem("firstVisit","true");
    }

    let managementCode = "MGMT2025";
    let generatedAccessCode = "";

    function showStep(stepId) {
      document.querySelectorAll(".step").forEach(div => div.style.display="none");
      document.getElementById(stepId).style.display="block";
    }

    function startShortChat() {
      document.getElementById("chatInstruction").innerHTML = "üí¨ Please click the green chat bubble at the bottom-right to begin chatting with management.";
      if(Tawk_API) Tawk_API.showWidget();

      // Auto-end after 5 mins
      setTimeout(() => {
        if(Tawk_API) Tawk_API.hideWidget();
        document.getElementById("chatInstruction").innerHTML = "‚è≥ Short Chat Ended ‚Äì Please reload this page and enter the code given to you by management.";
        localStorage.setItem("shortChatEnded","true");
      }, 300000);
    }

    function verifyCode() {
      let input = document.getElementById("mgmtCode").value;
      if(input === managementCode) {
        localStorage.setItem("managementCodeVerified","true");
        document.getElementById("codeMsg").innerHTML = "‚úÖ Correct! Reload the page to continue.";
      } else {
        document.getElementById("codeMsg").innerHTML = "‚ùå Invalid Code.";
      }
    }

    function markPaymentDone() {
      localStorage.setItem("paymentDone","true");
      document.getElementById("payMsg").innerHTML = "‚úÖ Payment marked. Reload the page to continue.";
    }

    function submitDetails() {
      let name = document.getElementById("fanName").value;
      let email = document.getElementById("fanEmail").value;
      let ref = document.getElementById("paymentRef").value;

      if(name && email && ref) {
        generatedAccessCode = Math.floor(100000 + Math.random() * 900000).toString();
        localStorage.setItem("detailsSubmitted","true");
        localStorage.setItem("accessCode",generatedAccessCode);
        document.getElementById("detailMsg").innerHTML = "‚úÖ Details submitted. Check your email for the access code.";
      } else {
        document.getElementById("detailMsg").innerHTML = "‚ö†Ô∏è Please fill in all fields.";
      }
    }

    function verifyAccessCode() {
      let input = document.getElementById("accessCode").value;
      let savedCode = localStorage.getItem("accessCode");
      if(input === savedCode) {
        document.getElementById("accessMsg").innerHTML = "‚úÖ Access Granted! Reload to start full chat.";
        if(Tawk_API) Tawk_API.showWidget();
      } else {
        document.getElementById("accessMsg").innerHTML = "‚ùå Invalid Access Code.";
      }
    }

    // Flow check on reload
    window.onload = function() {
      if(localStorage.getItem("detailsSubmitted")) {
        showStep("step5");
      } else if(localStorage.getItem("paymentDone")) {
        showStep("step4");
      } else if(localStorage.getItem("managementCodeVerified")) {
        showStep("step3");
      } else if(localStorage.getItem("shortChatEnded")) {
        showStep("step2");
      } else {
        showStep("step1");
      }
    }

    // Wallet copy
    function copyWallet(type) {
      let text = (type === "btc")
        ? "bc1ql35qu8wzlpc5cs5d7hgtk5srep48f7j0x27yr0"
        : "TVEKPhAMmXQwC7GR95UJrDV8DEboUHJBYW";
      navigator.clipboard.writeText(text);
      alert(type.toUpperCase() + " wallet copied!");
    }
  </script>

</body>
</html>
